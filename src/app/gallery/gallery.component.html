<div class="min-h-screen bg-gray-50 py-8">
  <div class="container mx-auto px-4">
    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-4xl font-bold text-gray-900 mb-4">Photo Gallery</h1>
      <p class="text-lg text-gray-600 max-w-2xl mx-auto">
        Explore our collection of news photos, events coverage, and exclusive visual stories.
      </p>
    </div>

    <!-- Filters and View Options -->
    <div class="flex flex-col md:flex-row justify-between items-center mb-6 space-y-4 md:space-y-0">
      <div class="flex space-x-2 flex-wrap gap-2">
        <button (click)="setFilter('all')"
                [class]="'px-4 py-2 rounded-lg font-medium transition ' +
                        (activeFilter === 'all' ? 'bg-blue-600 text-white' : 'bg-white text-gray-700 hover:bg-gray-100')">
          All Photos
        </button>
        <button *ngFor="let category of categories"
                (click)="setFilter(category)"
                [class]="'px-4 py-2 rounded-lg font-medium transition ' +
                        (activeFilter === category ? 'bg-blue-600 text-white' : 'bg-white text-gray-700 hover:bg-gray-100')">
          {{ category }}
        </button>
      </div>

      <div class="flex items-center space-x-4">
        <!-- Search -->
        <div class="relative">
          <input type="text"
                 [(ngModel)]="searchQuery"
                 (input)="onSearch()"
                 placeholder="Search photos..."
                 class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-64">
          <svg class="w-5 h-5 text-gray-400 absolute left-3 top-2.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
        </div>

        <!-- View Mode Toggle -->
        <div class="bg-white rounded-lg p-1 border border-gray-200 inline-flex">
          <button (click)="setViewMode('grid')"
                  [class]="'p-2 rounded ' + (viewMode === 'grid' ? 'bg-blue-600 text-white' : 'text-gray-600 hover:text-gray-800')">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"/>
            </svg>
          </button>
          <button (click)="setViewMode('masonry')"
                  [class]="'p-2 rounded ' + (viewMode === 'masonry' ? 'bg-blue-600 text-white' : 'text-gray-600 hover:text-gray-800')">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"/>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Photos Count -->
    <div class="mb-6">
      <p class="text-gray-600">
        Showing {{ filteredPhotos.length }} of {{ allPhotos.length }} photos
        <span *ngIf="activeFilter !== 'all'">in {{ activeFilter }}</span>
      </p>
    </div>

    <!-- Photos Grid -->
    <div *ngIf="filteredPhotos.length > 0; else noPhotos">
      <!-- Grid View -->
      <div *ngIf="viewMode === 'grid'"
           class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">

        <div *ngFor="let photo of displayedPhotos; let i = index"
             (click)="openLightbox(i)"
             class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-all duration-300 cursor-pointer group">

          <!-- Photo -->
          <div class="relative overflow-hidden">
            <img [src]="photo.fileUrl"
                 [alt]="photo.title"
                 class="w-full h-64 object-cover group-hover:scale-110 transition-transform duration-500"
                 (load)="onImageLoad(photo)"
                 [class.opacity-0]="!photo.loaded">

            <!-- Loading State -->
            <div *ngIf="!photo.loaded" class="absolute inset-0 flex items-center justify-center bg-gray-200">
              <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
            </div>

            <!-- Overlay -->
            <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all duration-300 flex items-end">
              <div class="p-4 text-white transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300">
                <h3 class="font-semibold text-lg mb-1">{{ photo.title }}</h3>
                <p class="text-sm opacity-90 line-clamp-2" *ngIf="photo.caption">{{ photo.caption }}</p>
                <div class="flex items-center justify-between mt-2 text-xs">
                  <span>{{ photo.createdAt  }}</span>
                  <span *ngIf="photo.category" class="bg-white bg-opacity-20 px-2 py-1 rounded">
                    {{ photo.category }}
                  </span>
                </div>
              </div>
            </div>

            <!-- Zoom Icon -->
            <div class="absolute top-3 right-3 bg-white bg-opacity-90 rounded-full p-2 transform scale-0 group-hover:scale-100 transition-transform duration-300">
              <svg class="w-4 h-4 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v0"/>
              </svg>
            </div>
          </div>
        </div>
      </div>

      <!-- Masonry View -->
      <div *ngIf="viewMode === 'masonry'" class="columns-1 md:columns-2 lg:columns-3 xl:columns-4 gap-6 space-y-6">
        <div *ngFor="let photo of displayedPhotos; let i = index"
             (click)="openLightbox(i)"
             class="break-inside-avoid bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-all duration-300 cursor-pointer group">

          <div class="relative">
            <img [src]="photo.fileUrl"
                 [alt]="photo.title"
                 class="w-full object-cover group-hover:scale-105 transition-transform duration-500"
                 [class.opacity-0]="!photo.loaded">

            <div *ngIf="!photo.loaded" class="absolute inset-0 flex items-center justify-center bg-gray-200 h-64">
              <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
            </div>

            <!-- Overlay -->
            <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all duration-300 flex items-end">
              <div class="p-4 text-white transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300 w-full">
                <h3 class="font-semibold text-lg mb-1">{{ photo.title }}</h3>
                <p class="text-sm opacity-90 line-clamp-2" *ngIf="photo.caption">{{ photo.caption }}</p>
              </div>
            </div>
          </div>

          <!-- Info below image in masonry -->
          <div class="p-4">
            <div class="flex items-center justify-between text-sm text-gray-500 mb-2">
              <span>{{ photo.createdAt | date:'MMM d, yyyy' }}</span>
              <span *ngIf="photo.category" class="bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs">
                {{ photo.category }}
              </span>
            </div>
            <p class="text-gray-600 text-sm" *ngIf="photo.caption">{{ photo.caption }}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Load More Button -->
    <div *ngIf="hasMorePhotos && filteredPhotos.length > 0" class="text-center mt-8">
      <button (click)="loadMore()"
              class="bg-white border border-gray-300 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-50 transition font-medium">
        Load More Photos
      </button>
    </div>

    <!-- No Photos Template -->
    <ng-template #noPhotos>
      <div class="text-center py-12">
        <svg class="w-16 h-16 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
        </svg>
        <h3 class="text-xl font-medium text-gray-600 mb-2">No Photos Found</h3>
        <p class="text-gray-500 max-w-md mx-auto">
          {{ searchQuery ? 'No photos match your search criteria.' : 'There are no photos available at the moment.' }}
        </p>
        <button *ngIf="searchQuery"
                (click)="clearSearch()"
                class="mt-4 text-blue-600 hover:text-blue-800 font-medium">
          Clear search
        </button>
      </div>
    </ng-template>
  </div>
</div>

<!-- Lightbox Modal -->
<div *ngIf="showLightbox" class="fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4">
  <div class="relative max-w-6xl max-h-full w-full">
    <!-- Close Button -->
    <button (click)="closeLightbox()"
            class="absolute top-4 right-4 text-white hover:text-gray-300 z-10 bg-black bg-opacity-50 rounded-full p-2">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
      </svg>
    </button>

    <!-- Navigation Arrows -->
    <button *ngIf="filteredPhotos.length > 1"
            (click)="previousPhoto()"
            class="absolute left-4 top-1/2 transform -translate-y-1/2 text-white hover:text-gray-300 z-10 bg-black bg-opacity-50 rounded-full p-3">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
      </svg>
    </button>

    <button *ngIf="filteredPhotos.length > 1"
            (click)="nextPhoto()"
            class="absolute right-4 top-1/2 transform -translate-y-1/2 text-white hover:text-gray-300 z-10 bg-black bg-opacity-50 rounded-full p-3">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
      </svg>
    </button>

    <!-- Image -->
    <div class="flex items-center justify-center h-full">
      <img [src]="filteredPhotos[currentLightboxIndex].fileUrl"
           [alt]="filteredPhotos[currentLightboxIndex].title"
           class="max-w-full max-h-full object-contain"
           (click)="nextPhoto()">
    </div>

    <!-- Image Info -->
    <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black to-transparent p-6 text-white">
      <h3 class="text-xl font-semibold mb-2">{{ filteredPhotos[currentLightboxIndex].title }}</h3>
      <p class="text-gray-200 mb-2" *ngIf="filteredPhotos[currentLightboxIndex].caption">
        {{ filteredPhotos[currentLightboxIndex].caption }}
      </p>
      <div class="flex items-center justify-between text-sm text-gray-300">
        <span>{{ filteredPhotos[currentLightboxIndex].createdAt }}</span>
        <span>{{ currentLightboxIndex + 1 }} / {{ filteredPhotos.length }}</span>
      </div>
    </div>
  </div>
</div>
